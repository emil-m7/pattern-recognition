<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="title" content="Распознавание на основе эталонов"><meta name="description" content="Решение задачи распознавания на основе алгоритма создания эталонов, заданных в виде изображений"><meta name="keywords" content="Распознавание образов, Класс, Объект, Образ"><meta name="robots" content="noindex, nofollow"><meta name="language" content="Russian"><meta name="author" content="https://github.com/emil-m7/"><title>Распознавание на основе эталонов</title><style>*{box-sizing:border-box}body{padding:0;margin:0}button{user-select:none}.d-none{display:none}.v-hidden{visibility:hidden}.screen{display:none}.screen.--active{display:block}.text-center{text-align:center}.h3-like{font-size:1.17em;font-weight:700}.mr-auto{margin-right:auto}.menu__inner{max-width:960px;padding:0 10px;margin:0 auto}.menu__inner.--max-content{display:flex;flex-direction:column;min-height:100vh}.menu__title{text-align:center;padding:20px;margin:0}.menu__title.--center{max-width:500px;margin:0 auto}.menu__items{display:flex;flex-direction:column;align-items:center;flex:1;list-style:none;padding:60px 0 30px;margin:0}.menu__item+.menu__item{padding-top:5px}.menu__item.--line{height:1px;width:170px;background-color:#999;padding:0;margin:10px 0 5px}.menu__btn{width:200px;padding:20px}.menu__version{text-align:center;opacity:.5;transition:.3s;padding:5px}.menu__version:hover{opacity:1}.addclass__inner{max-width:960px;padding:0 10px;margin:0 auto}.addclass__inner.--max-content{display:flex;flex-direction:column;min-height:100vh}.addclass__nav{display:flex;align-items:center}.addclass__content{flex:1;padding-bottom:20px}.addclass__back-btn:before{content:"<"}.addclass__title{padding:20px;margin:0}.addclass__label{font-size:20px;font-weight:700;padding-top:20px;padding-bottom:10px}.addclass__canvas-container{display:flex;flex-wrap:wrap}.addclass__canvas-container.--center{justify-content:center}.addclass__canvas,.addclass__canvas-wrp canvas{display:block;box-shadow:0 0 4px 0 #a3a3a3;border-radius:5px}.addclass__canvas-tools{padding-left:20px}.addclass__canvas-tools-items{list-style:none;padding:0;margin:0}@media (min-width:460px){.addclass__canvas-tools-item+.addclass__canvas-tools-item{padding-top:10px}}.addclass__canvas-tools-btn{padding:20px;width:100%}@media (max-width:460px){.addclass__canvas-tools{width:300px;padding:10px 0 0}.addclass__canvas-tools-items{display:flex;justify-content:center;flex-wrap:wrap;margin:0 -5px}.addclass__canvas-tools-item{flex:1;max-width:155px;padding:5px}.addclass__canvas-tools-btn{white-space:nowrap}}.addclass__obj-items{display:flex;list-style:none;padding:0;margin:0;overflow:auto}.addclass__obj-item{position:relative;padding:10px}.addclass__obj-acts{position:absolute;top:13px;right:13px;transition:.3s;visibility:hidden;opacity:0}.addclass__obj-item:hover .addclass__obj-acts{visibility:visible;opacity:1}.addclass__obj-btn{display:block;height:30px;width:30px;border:1px solid gray;border-radius:50%;background-position:center;background-repeat:no-repeat;background-size:20px;cursor:pointer}.addclass__obj-btn:disabled{opacity:.3;cursor:default}.addclass__obj-btn+.addclass__obj-btn{margin-top:5px}.addclass__obj-btn.--edit{background-image: url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23000' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11.4922 2.789H7.75324C4.67824 2.789 2.75024 4.966 2.75024 8.048V16.362C2.75024 19.444 4.66924 21.621 7.75324 21.621H16.5772C19.6622 21.621 21.5812 19.444 21.5812 16.362V12.334' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' /%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.82763 10.9209L16.3006 3.44793C17.2316 2.51793 18.7406 2.51793 19.6716 3.44793L20.8886 4.66493C21.8196 5.59593 21.8196 7.10593 20.8886 8.03593L13.3796 15.5449C12.9726 15.9519 12.4206 16.1809 11.8446 16.1809H8.09863L8.19263 12.4009C8.20663 11.8449 8.43363 11.3149 8.82763 10.9209Z' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' /%3E%3Cpath d='M15.165 4.60254L19.731 9.16854' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' /%3E%3C/svg%3E")}.addclass__obj-btn.--delete{background-color:#f1c3c3;background-image:url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23000' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M19.325 9.4682C19.325 9.4682 18.782 16.2032 18.467 19.0402C18.317 20.3952 17.48 21.1892 16.109 21.2142C13.5 21.2612 10.888 21.2642 8.28003 21.2092C6.96103 21.1822 6.13803 20.3782 5.99103 19.0472C5.67403 16.1852 5.13403 9.4682 5.13403 9.4682' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' /%3E%3Cpath d='M20.7082 6.23969H3.75024' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' /%3E%3Cpath d='M17.4406 6.23967C16.6556 6.23967 15.9796 5.68467 15.8256 4.91567L15.5826 3.69967C15.4326 3.13867 14.9246 2.75067 14.3456 2.75067H10.1126C9.53358 2.75067 9.02558 3.13867 8.87558 3.69967L8.63258 4.91567C8.47858 5.68467 7.80258 6.23967 7.01758 6.23967' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' /%3E%3C/svg%3E")}.addclass__obj-img,.addclass__template-img{display:block;width:150px;height:150px;box-shadow:0 0 4px 0 #a3a3a3;transition:.3s;border-radius:5px}.addclass__obj-item.--active .addclass__obj-img,.addclass__obj-item.--active .addclass__template-img{box-shadow:0 0 7px 0 green}.addclass__template-img{width:200px;height:200px}.addclass__template-img[src=""]{display:none}.addclass__footer{background-color:#fff;box-shadow:0 0 4px 0 #a3a3a3;border-radius:5px 5px 0 0}.addclass__footer.--sticky{position:sticky;bottom:0}.addclass__footer-acts{display:flex;justify-content:flex-end;padding:5px}.addclass__footer-btn{padding:5px}.addclass__footer-btn+.addclass__footer-btn{margin-left:10px}.recpanel__inner{max-width:960px;padding:0 10px;margin:0 auto}.recpanel__nav{display:flex;align-items:center}.recpanel__back-btn:before{content:"<"}.recpanel__title{padding:20px;margin:0}.recpanel__label{font-size:20px;font-weight:700;padding-top:20px;padding-bottom:10px}.recpanel__canvas-container{display:flex;flex-wrap:wrap}.recpanel__canvas-container.--center{justify-content:center}.recpanel__canvas,.recpanel__canvas-wrp canvas{display:block;box-shadow:0 0 4px 0 #a3a3a3;border-radius:5px}.recpanel__canvas-tools{padding-left:20px}.recpanel__canvas-tools-items{list-style:none;padding:0;margin:0}@media (min-width:460px){.recpanel__canvas-tools-item{min-width:115px;padding-bottom:10px}}.recpanel__canvas-tools-btn{padding:20px;width:100%}@media (max-width:460px){.recpanel__canvas-tools{width:300px;padding:10px 0 0}.recpanel__canvas-tools-items{display:flex;flex-wrap:wrap;margin:0 -5px}.recpanel__canvas-tools-item{flex:1;max-width:155px;padding:5px}.recpanel__canvas-tools-btn{white-space:nowrap}}.recpanel__resinfo{background-color:#cfdeeb;border-radius:7px;padding:10px}.recpanel__resinfo-btn.--link-like{display:inline;font:inherit;cursor:pointer;background:0 0;border:none;padding:0;margin:0}.recpanel__resinfo-btn.--link-like span{color:#00f;text-decoration:underline}.recpanel__resinfo-btn.--link-like:active span{color:red}.recpanel__details-items{padding-bottom:40px}.recpanel__details-item{display:flex;justify-content:center;flex-wrap:wrap;box-shadow:0 0 4px 0 #a3a3a3;border-radius:5px;overflow:hidden}.recpanel__details-item+.recpanel__details-item{margin-top:15px}.recpanel__details-item.--most-probable{background-color:#f0fff1;box-shadow:0 0 4px 0 green,0 0 14px 0 green}.recpanel__details-img{display:block;width:300px;height:300px}.recpanel__details-params{flex:1;display:block;min-width:300px;list-style:none;padding:10px;margin:0}.recpanel__details-param+.recpanel__details-param{padding-top:5px}.recpanel__details-param.--title{font-weight:700;text-align:center;padding-bottom:10px}.addclass__canvas-wrp,.recpanel__canvas-wrp{background-image:linear-gradient(0deg,transparent 2px,rgba(0,0,0,.2) 2px,rgba(0,0,0,.2) 3px,transparent 3px),linear-gradient(90deg,transparent 2px,rgba(0,0,0,.2) 2px,rgba(0,0,0,.2) 3px,transparent 3px);background-position:center;background-size:236px 236px}.classmanager__inner{max-width:960px;padding:0 10px;margin:0 auto}.classmanager__inner.--max-content{display:flex;flex-direction:column;min-height:100vh}.classmanager__nav{display:flex;align-items:center}.classmanager__back-btn:before{content:"<"}.classmanager__title{padding:20px;margin:0}.classmanager__classes{flex:1;list-style:none;padding:20px 0;margin:0}.classmanager__class+.classmanager__class{padding-top:20px}.classmanager__row{display:flex;align-items:center}.classmanager__class{display:flex}.classmanager__class-tmp-wrp{padding-right:20px}.classmanager__class-tmp{display:block;width:200px;height:200px;box-shadow:0 0 4px #a3a3a3;border-radius:5px}.classmanager__class-info{overflow:hidden}.classmanager__class-name{overflow:hidden;text-overflow:ellipsis;padding:0;margin:0}.classmanager__class-info-items{list-style:none;padding:15px 0;margin:0}.classmanager__class-acts{display:flex;flex-wrap:wrap;margin:-2.5px}.classmanager__class-abtn{margin:2.5px}@media (max-width:500px){.classmanager__class-tmp-wrp{padding-right:unset}.classmanager__class-info{padding:20px 0}.classmanager__class{flex-direction:column;max-width:300px;margin:0 auto}.classmanager__class-tmp-wrp{text-align:center}.classmanager__class-tmp{display:inline-block}}.classmanager__footer{background-color:#fff;box-shadow:0 0 4px 0 #a3a3a3;border-radius:5px 5px 0 0}.classmanager__footer.--sticky{position:sticky;bottom:0}.classmanager__footer-acts{display:flex;justify-content:flex-end;padding:5px}.classmanager__footer-btn{padding:5px}.classmanager__footer-btn+.classmanager__footer-btn{margin-left:10px}@media (max-width:474px){.classmanager__footer-btn span{visibility:hidden;font-size:0}}@media (max-width:341px){.classmanager__footer-acts{justify-content:space-between}.classmanager__footer-btn+.classmanager__footer-btn{margin-left:unset}}.classreview__inner{max-width:960px;padding:0 10px;margin:0 auto}.classreview__inner.--max-content{display:flex;flex-direction:column;min-height:100vh}.classreview__nav{display:flex;align-items:center}.classreview__back-btn:before{content:"<"}.classreview__classname{padding:20px;margin:0}.classreview__content{flex:1;padding-bottom:20px}.classreview__title{padding:10px;margin:0}.classreview__gal-items{display:grid;grid-template-columns:repeat(auto-fill,300px);grid-gap:20px;list-style:none;padding:0;margin:0}.classreview__img{display:block;width:300px;height:300px;box-shadow:0 0 4px #a3a3a3;border-radius:5px;margin:0 auto}.classreview__footer{background-color:#fff;box-shadow:0 0 4px 0 #a3a3a3;border-radius:5px 5px 0 0}.classreview__footer.--sticky{position:sticky;bottom:0}.classreview__footer-acts{display:flex;justify-content:flex-end;padding:5px}.classreview__footer-btn{padding:5px}.classreview__footer-btn+.classreview__footer-btn{margin-left:10px}.addclass__nav.--sticky,.classmanager__nav.--sticky,.classreview__nav.--sticky,.recpanel__nav.--sticky,.reference__nav.--sticky{position:sticky;top:0;background-color:#fff;box-shadow:0 0 4px 0 #a3a3a3;border-radius:0 0 5px 5px;padding:5px}.addclass__title,.classmanager__title,.classreview__classname,.recpanel__title,.reference__title{text-overflow:ellipsis;overflow:hidden}.addclass__nav.--sticky .addclass__title,.classmanager__nav.--sticky .classmanager__title,.classreview__nav.--sticky .classreview__classname,.recpanel__nav.--sticky .recpanel__title,.reference__nav.--sticky .reference__title{font-size:1.2em;padding:5px;padding-left:15px;white-space:nowrap}.reference__inner{max-width:960px;padding:0 10px;margin:0 auto}.reference__inner.--max-content{display:flex;flex-direction:column;min-height:100vh}.reference__nav{display:flex;align-items:center}.reference__back-btn:before{content:"<"}.reference__title{padding:20px;margin:0}.reference__content{flex:1;padding-bottom:20px}.reference__footer{padding:10px 0;text-align:center}.popup{position:fixed;top:0;left:0;width:100%;height:100%;padding:100px 10px 50px;margin:0;z-index:1}.popup__overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:#000;opacity:.3;z-index:-1}.popup__popup{max-width:320px;background-color:#fff;border-radius:5px;box-shadow:0 0 4px #a3a3a3;padding:10px;margin:0 auto}.popup__nav{display:flex}.popup__content{padding:20px 0}.popup__title{font-size:1.17em;font-weight:700}.popup__close-btn{margin-left:auto}.popup__nav.--center{flex-direction:row;justify-content:flex-end;justify-content:space-evenly}.popup__nav-btn{min-width:64px;margin:0 10px}.popup__content-p{padding:0;margin:0}.popup__content-p+.popup__content-p{margin-top:1em}.up-button{position:fixed;bottom:45px;right:20px;display:block;height:80px;width:80px;font-size:100px;background-color:transparent;background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M13.471 11.4423L9.99996 7.9563L6.52896 11.4423M19.2498 10C19.2498 4.892 15.1088 0.75 9.99976 0.75C4.89176 0.75 0.749756 4.892 0.749756 10C0.749756 15.108 4.89176 19.25 9.99976 19.25C15.1088 19.25 19.2498 15.108 19.2498 10Z' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' stroke='%23000'/%3E%3C/svg%3E%0A");background-repeat:no-repeat;background-position:center;background-size:55px;transition:50ms;padding:0;margin:0;border:0}.up-button:active{transform:scale(.95)}.up-button.d-none{visibility:hidden}</style></head><body><section id="sc1" class="menu screen --active"><div id="mb_inner" class="menu__inner --max-content"><h1 class="menu__title --center">Решение задачи распознавания на основе алгоритма создания эталонов, заданных в виде изображений</h1><ul class="menu__items"><li class="menu__item"><button class="menu__btn" id="mb_addnewclass">Добавить класс</button></li><li class="menu__item"><button class="menu__btn" id="mb_classmanager">Управление классами</button></li><li class="menu__item"><button class="menu__btn" id="mb_recognition">Распознавание</button></li><li class="menu__item --line"></li><li class="menu__item"><button class="menu__btn" id="mb_reference">Справка</button></li><li class="menu__item d-none"><button class="menu__btn" id="mb_settings" disabled="disabled">Настройки</button></li><li class="menu__item d-none"><button class="menu__btn" onclick="location=location">Перезагрузка</button></li></ul><div class="menu__version">Версия 1.28</div></div></section><section id="sc4" class="classmanager screen"><div class="classmanager__inner --max-content"><div id="cm_navbar" class="classmanager__nav"><button id="cm_back" class="classmanager__back-btn"></button><h2 class="classmanager__title">Управление классами</h2></div><ul id="cm_classes" class="classmanager__classes d-none"></ul><div id="cm_empty_ms" class="classmanager__empty"><h3 class="classmanager__empty-title">Классов не зарегистрировано</h3><div class="classmanager__empty-acts"><button id="cm_addclass_btn" class="classmanager__empty-btn">Добавить класс</button>&nbsp;<button id="cm_loadclass_btn" class="classmanager__empty-btn">Загрузить классы</button></div></div><div id="cm_footer" class="classmanager__footer --sticky d-none"><div class="classmanager__footer-acts"><button id="cm_f_addclass_btn" class="classmanager__footer-btn">Добавить&nbsp;<span>класс</span></button><button id="cm_f_loadclass_btn" class="classmanager__footer-btn">Загрузить&nbsp;<span>классы</span></button><button id="cm_f_saveclass_btn" class="classmanager__footer-btn">Сохранить&nbsp;<span>классы</span></button><button id="cm_f_back_btn" class="classmanager__footer-btn">Назад</button></div></div></div></section><section id="sc5" class="classreview screen"><div class="classreview__inner --max-content"><div id="cr_navbar" class="classreview__nav"><button id="cr_back" class="classreview__back-btn"></button><h2 id="cr_title" class="classreview__classname">Название класса</h2></div><div class="classreview__content"><h3 class="classreview__title">Эталон</h3><ul id="cr_temp_gal" class="classreview__gal-items"></ul><h3 class="classreview__title">Объекты</h3><ul id="cr_obj_gal" class="classreview__gal-items"></ul></div><div class="classreview__footer --sticky"><div class="classreview__footer-acts"><button id="cr_edit_btn" class="classreview__footer-btn">Редактировать</button><button id="cr_remove_btn" class="classreview__footer-btn mr-auto">Удалить</button><button id="cr_f_back_btn" class="classreview__footer-btn">Назад</button></div></div></div></section><section id="sc2" class="addclass screen"><div class="addclass__inner --max-content"><div id="ac_navbar" class="addclass__nav"><button id="ac_back_btn" class="addclass__back-btn"></button><h2 id="ac_title" class="addclass__title">Создание нового класса</h2></div><div class="addclass__content"><div class="addclass__label"><span>Название класса:</span><input type="text" id="ac_in_classname" placeholder="Название класса"></div><div class="addclass__label">Графическая область:</div><div class="addclass__canvas-container"><div id="ac_cnv_wrp" class="addclass__canvas-wrp"></div><div class="addclass__canvas-tools"><ul class="addclass__canvas-tools-items"><li class="addclass__canvas-tools-item"><button id="ac_bt_clear" class="addclass__canvas-tools-btn">Очистить</button></li><li class="addclass__canvas-tools-item"><button id="ac_bt_newobj" class="addclass__canvas-tools-btn">Добавить</button></li><li class="addclass__canvas-tools-item d-none"><button id="ac_bt_cnlchg" class="addclass__canvas-tools-btn">Отмена</button></li><li class="addclass__canvas-tools-item d-none"><button id="ac_bt_change" class="addclass__canvas-tools-btn">Изменить</button></li></ul></div></div><div class="addclass__label">Предпросмотр эталона:</div><div class="addclass__template"><div class="addclass__template-wrp"><img id="ac_temp_img" class="addclass__template-img" src="" alt=""></div></div><div class="addclass__label">Объекты класса (<span id="ac_obj_cnt">0</span>):</div><div class="addclass__obj-gallery"><ul id="ac_obj_gal" class="addclass__obj-items"></ul></div></div><div class="addclass__footer --sticky"><div class="addclass__footer-acts"><button class="addclass__footer-btn" id="ac_bt_submit">Добавить класс</button><button class="addclass__footer-btn" id="ac_bt_cancel">Отмена</button></div></div></div></section><section id="sc3" class="recpanel screen"><div class="recpanel__inner"><div id="rp_navbar" class="recpanel__nav"><button id="rp_bt_back" class="recpanel__back-btn"></button><h2 class="recpanel__title">Распознавание образов</h2></div><div class="recpanel__label">Графическая область:</div><div class="recpanel__canvas-container"><div id="rp_canvas_wrp" class="recpanel__canvas-wrp"></div><div class="recpanel__canvas-tools"><ul class="recpanel__canvas-tools-items"><li class="recpanel__canvas-tools-item"><button id="rp_bt_cls" class="recpanel__canvas-tools-btn">Очистить</button></li><li class="recpanel__canvas-tools-item"><button id="rp_bt_rcg" class="recpanel__canvas-tools-btn">Распознать</button></li></ul></div></div><p id="rp_resinfo" class="recpanel__resinfo d-none"><span id="rp_resinfo_txt" class="recpanel__resinfo-txt">Образ пренадлежит классу А</span>.&nbsp;<button id="rp_details_btn" class="recpanel__resinfo-btn --link-like"><span>Подробности</span>.</button></p><div id="rp_details" class="recpanel__details d-none"><div class="recpanel__label">Графическое сравнение:</div><div class="recpanel__details-items"></div></div></div></section><section id="sc6" class="reference screen"><div class="reference__inner --max-content"><div id="rf_navbar" class="reference__nav"><button id="rf_back_btn" class="reference__back-btn"></button><h1 class="reference__title">Справка</h1></div><div class="reference__content"><h2>Распознавание на основе создания изображений-эталонов</h2><p class="h3-like">Решение задачи распознавания образов заданных в виде изображений на основе алгоритма создания эталонов и алгоритма вычисления коэффициента сходства.</p><h2>Принцип работы</h2><p>Принцип работы данной программой можно разбить на два основных этапа: регистрация классов и распознавание новых образов.</p><h3>Первый этап - Регистрация классов</h3><p>На данном этапе пользователь имеет два способа для регистрации классов в программе.</p><p><strong>Первый способ</strong>&nbsp;включает в себя ручное создание классов. Для этого необходимо выполнить следующие шаги:</p><ol><li>Перейти в раздел &quot;Добавить класс&quot;.</li><li>В текстовом поле &quot;Название класса&quot; указать наименование класса.</li><li>В &quot;Графической области&quot; нарисовать объект, представляющий класс, и затем нажать на кнопку &quot;Добавить&quot;.</li><li>Повторить шаг 3 до получения четкого эталона класса.</li><li>После этого следует нажать на кнопку &quot;Добавить класс&quot;.</li></ol><p><em>Для перехода к следующему этапу необходимо зарегистрировать как минимум два класса.</em></p><p><strong>Второй способ</strong>&nbsp;включает в себя загрузку сохраненных классов и выполняется по следующим шагам:</p><ol><li>Перейти в раздел &quot;Управление классами&quot;.</li><li>Нажать на кнопку &quot;Загрузить классы&quot;.</li><li>В открывшемся окне выбрать сохранённые файлы с расширением&nbsp;<code>.json</code>.</li><li>Произойдет обработка файла, и в случае его целостности классы будут зарегистрированы в программе.</li></ol><p><em>В зависимости от объёма информации обработка файла может занять некоторое время.</em></p><h3>Второй этап - Распознавание новых образов</h3><p>Для того чтобы программа распознала новые образы, следует выполнить следующие шаги:</p><ol><li>Перейти в раздел &quot;Распознавание&quot;.</li><li>В графической области нарисовать новый образ.</li><li>Затем нажать на кнопку &quot;Распознать&quot;.</li><li>Появится информация с результатами распознавания.</li><li>Для получения дополнительной информации о распознавании, нужно нажать на кнопку &quot;Подробности&quot;.</li><li>Для того чтобы распознать другой образ, следует нажать кнопку &quot;Очистить&quot; рядом с графической областью.</li></ol><h3>Актуализация и сохранение классов</h3><p>Пользователь имеет возможность актуализировать и сохранить созданные классы с целью их последующего использования в последующих сессиях.</p><p>Процедура включает в себя следующие шаги:</p><ol><li>Переход в раздел &quot;Управление классами&quot;.</li><li>Выбор опции &quot;Сохранить классы&quot; путем нажатия соответствующей кнопки.</li><li>В открывшемся диалоговом выберите опцию сохранения и нажмите кнопку "Ок".</li><li>Начнётся процесс подготовки данных к сохранению с соответствующей индикацией состояния.</li><li>По завершению подготовки нажмите на кнопку "Сохранить".</li><li>Далее пользователю предоставляется возможность выбрать местоположение, где данные могут быть сохранены.</li></ol><p><em>Предоставляются две опции для сохранения: полное сохранение классов и сохранение только эталонов классов. Выбор конкретной опции будет иметь влияние на время выполнения операции сохранения и объем хранимой информации. Однако в любом случае сохранённые данные могут быть использованы в последующих операциях распознавания.</em></p></div><div class="reference__footer"><div>di-113-19, Махмудов Эмиль.</div><div>Самарканд 2023 год.</div></div></div></section><script>function crtElm(tag,attrs,_child){var elem=document.createElement(tag);if(attrs)if("string"==typeof attrs)elem.setAttribute("class",attrs);else for(key in attrs)elem.setAttribute(key,attrs[key]);return _child&&(Array.isArray(_child)?_child.forEach((function(i){"object"==typeof i&&"HTML"in i?elem.insertAdjacentHTML("beforeend",i.HTML):(i instanceof HTMLElement||"string"==typeof i)&&elem.append(i)})):"object"==typeof _child&&"HTML"in _child?elem.insertAdjacentHTML("beforeend",_child.HTML):(_child instanceof HTMLElement||"string"==typeof _child)&&elem.append(_child)),elem}function newElem(tag,attrs,_child){let el=crtElm(tag,attrs,_child);return el.on=function(){return this.addEventListener(...arguments),this},el.insertToBody=function(){return document.body.append(this),this},el.insertTo=function(query=""){return document.querySelector(query).append(this),this},el.getRef=function(func=(_=>_)){return func(this),this},el}function getParentNode(el,lvl=0){return 0==lvl?el:getParentNode(el.parentElement,lvl-1)}function easyPopup(){let title=null,close_btn=null,content=null,footer=null,el=newElem("div","popup",[crtElm("div","popup__popup",crtElm("div","popup__inner",[crtElm("div","popup__header",crtElm("div","popup__nav",[newElem("div","popup__title","Внимание").getRef(el=>title=el),newElem("button","popup__close-btn","X").getRef(el=>close_btn=el)])),newElem("div","popup__content").getRef(el=>content=el),crtElm("div","popup__footer",newElem("div","popup__nav --center").getRef(el=>footer=el))])),crtElm("div","popup__overlay")]),opened=!1;el.open=function(){return opened||(el.insertToBody(),opened=!0),document.documentElement.style.overflow="hidden",el},el.close=function(){return opened&&(el.remove(),opened=!1),document.documentElement.style.overflow="",el},el.set_title=function(str=""){return str&&(title.innerText=str),el};let close_btn_enabled=!0;return el.disable_close_btn=function(){return close_btn_enabled&&(close_btn.setAttribute("disabled","true"),close_btn.classList.add("d-none"),close_btn_enabled=!1),el},el.enable_close_btn=function(){return close_btn_enabled||(close_btn.removeAttribute("disabled"),close_btn.classList.remove("d-none"),close_btn_enabled=!0),el},close_btn.addEventListener("click",(function(){close_btn_enabled&&el.close()})),el.append_to_content=function(elem){return content.append(elem),el},el.prepend_to_content=function(elem){return content.prepend(elem),el},el.append_text_to_content=function(text=""){return content.append(crtElm("div","popup__content-p",text)),el},el.prepend_text_to_content=function(text=""){return content.prepend(crtElm("div","popup__content-p",text)),el},el.clear_content=function(){return content.innerHTML="",el},el.add_action_to_footer=function(title="action",cb=(_=>_)){function __cb(){return cb.bind(el,...arguments)}return footer.append(newElem("button","popup__nav-btn",title).on("click",__cb())),el},el.remove_actions_from_footer=function(){return footer.innerHTML="",el},el}function StickyNavbar(elemId=""){let navbar=document.getElementById(elemId),normal_navbar_height=0,sticky_navbar_height=0,distance_to_bottom_border=0,is_sticky_now=!1;function define_navbar_sizes(){navbar.classList.remove("--sticky"),normal_navbar_height=navbar.offsetHeight,distance_to_bottom_border=pageYOffset+navbar.getBoundingClientRect().y+normal_navbar_height/2,navbar.classList.add("--sticky"),sticky_navbar_height=navbar.offsetHeight,is_sticky_now?navbar.style.marginBottom=normal_navbar_height-sticky_navbar_height+"px":navbar.classList.remove("--sticky")}function onscroll(){pageYOffset>distance_to_bottom_border?is_sticky_now||(navbar.style.marginBottom=normal_navbar_height-sticky_navbar_height+"px",navbar.classList.add("--sticky"),is_sticky_now=!0):is_sticky_now&&(navbar.classList.remove("--sticky"),navbar.style.marginBottom="0",is_sticky_now=!1)}this.start_listen=function(){window.addEventListener("scroll",onscroll),window.addEventListener("resize",define_navbar_sizes),window.addEventListener("orientationchange",define_navbar_sizes),document.addEventListener("fullscreenchange",define_navbar_sizes),is_sticky_now=!1,define_navbar_sizes(),onscroll()},this.stop_listen=function(){window.removeEventListener("scroll",onscroll),window.removeEventListener("resize",define_navbar_sizes),window.removeEventListener("orientationchange",define_navbar_sizes),document.removeEventListener("fullscreenchange",define_navbar_sizes),navbar.classList.remove("--sticky"),navbar.removeAttribute("style")}}function upButton(){let el=newElem("button","up-button d-none");function __scrollUp(){window.scrollTo(0,0)}function __onscroll(){const scrollY=window.scrollY||document.documentElement.scrollTop;scrollY<400?el.classList.add("d-none"):el.classList.remove("d-none")}return el.start=function(){el.addEventListener("pointerup",__scrollUp),window.addEventListener("scroll",__onscroll),__onscroll(),document.body.append(el)},el.stop=function(){el.removeEventListener("pointerup",__scrollUp),window.removeEventListener("scroll",__onscroll),el.remove()},el};function Sketch(w=50,h=50,prms={}){const cnv=document.createElement("canvas");let HEIGHT=h,WIDTH=w;this.height=HEIGHT,this.width=WIDTH,cnv.setAttribute("height",HEIGHT),cnv.setAttribute("width",WIDTH),cnv.setAttribute("tabindex","-1");const ctx=cnv.getContext("2d");this.cnv=cnv,this.ctx=ctx;const that=this;this.insert_into=function(selector="body",append=!0){let elem=null;return selector instanceof HTMLElement?elem=selector:"string"==typeof selector&&(elem=document.querySelector(selector)),elem&&(append?elem.append(cnv):elem.prepend(cnv)),this},prms.insert_into&&this.insert_into(prms.insert_into);let dm=!1;function draw(e){ctx.beginPath();let coords=cnv.getBoundingClientRect();function drawing(e){ctx.lineTo(e.clientX-coords.x,e.clientY-coords.y),ctx.stroke()}function removeListeners(e2){if(e.clientX==e2.clientX&&e.clientY==e2.clientY){let temp=ctx.fillStyle;ctx.fillStyle=ctx.strokeStyle,ctx.fillRect(e2.clientX-coords.x-1,e2.clientY-coords.y-1,2,2),ctx.fillStyle=temp}document.removeEventListener("pointermove",drawing),document.removeEventListener("pointerup",removeListeners)}ctx.moveTo(e.clientX-coords.x,e.clientY-coords.y),document.addEventListener("pointermove",drawing),document.addEventListener("pointerup",removeListeners)}this.drawing_mode=dm,this.enable_drawing_mode=function(){return dm?this:(cnv.addEventListener("pointerdown",draw),cnv.style.touchAction="none",cnv.style.userSelect="none",this.drawing_mode=dm=!0,this)},this.disable_drawing_mode=function(){return dm?(cnv.removeEventListener("pointerdown",draw),cnv.style.touchAction="",cnv.style.userSelect="",this.drawing_mode=dm=!1,this):this},this.switch_drawing_mode=function(f1=null){return!0===f1?this.enable_drawing_mode():!1===f1?this.disable_drawing_mode():null===f1&&(dm?this.disable_drawing_mode():this.enable_drawing_mode()),this},prms.drawing_mode&&!0===prms.drawing_mode&&this.enable_drawing_mode(),this.for_each_pixel=function(func=(_=>_)){let img_data=ctx.getImageData(0,0,WIDTH,HEIGHT);img_data=img_data.data;let ii=0,rgba=[];for(let i=0;i<img_data.length;i++)rgba.push(img_data[i]),ii++,ii>3&&(func(rgba),rgba=[],ii=0)};let prev_fill_style="black";this.get_fill_style=function(){return ctx.fillStyle},this.get_prev_fill_style=function(){return prev_fill_style},this.set_fill_style=function(color="black"){"string"==typeof color&&(prev_fill_style=ctx.fillStyle,ctx.fillStyle=color)},this.set_prev_fill_style=function(){ctx.fillStyle=prev_fill_style},this.rect=function(x=0,y=0,w=1,h=1,color=null){"string"==typeof color?(that.set_fill_style(color),ctx.fillRect(x,y,w,h),that.set_prev_fill_style()):ctx.fillRect(x,y,w,h)},this.dot=function(x=0,y=0,color=null){this.rect(x,y,1,1,color)},this.resetSizes=function(w,h){HEIGHT=h,WIDTH=w,that.width=WIDTH,that.height=HEIGHT,cnv.setAttribute("width",WIDTH),cnv.setAttribute("height",HEIGHT)},this.clear=function(){ctx.clearRect(0,0,WIDTH,HEIGHT)}};function DB(){let CLASSNAMES=[],TEMPLATES=[],OBJECTS=[],classesConut=0,has_unsaved_data=!1;const setTimeoutDelay=0,that=this;function numberConvertor(symbols){const S=symbols,L=symbols.length;function convert_to_symbol(number=0){let result="";for(;number>0;){const remainder=(number-1)%L,letter=symbols[remainder];result=letter+result,number=Math.floor((number-1)/L)}return result}function convert_to_number(letters=""){const base=L;let result=0;for(let letter of letters){const letterValue=S.indexOf(letter)+1;letterValue&&(result=result*base+letterValue)}return result}this.ts=function(number=0){return convert_to_symbol(number)},this.tn=function(letters=""){return convert_to_number(letters)}}this.length=classesConut;const LINK_SYMBOLS_LA="abcdefghijklmnopqrstuvwxyz",LINK_SYMBOLS_CY="абвгдеёжзийклмнопрстуфхцчшщъыьэюя",LA=new numberConvertor(LINK_SYMBOLS_LA),CY=new numberConvertor(LINK_SYMBOLS_CY);function findSubstringOccurrences(searchValue,string){if(!searchValue||!string||!string.includes(searchValue))return[];for(var result=[],pos=0;;){let foundPos=string.indexOf(searchValue,pos);if(-1==foundPos)break;pos=foundPos+searchValue.length,result.push(foundPos)}return result}function compress_1(arr=[]){let res="",cv=null,cc=0;for(let el of arr)cv===el?cc++:cv!==el&&(res+=cc>2?`${cv}${LA.ts(cc)}`:`${cv}`.repeat(cc),cv=el,cc=1);return res+=cc>2?`${cv}${LA.ts(cc)}`:`${cv}`.repeat(cc),res}function compress_2(i_str=""){function search(str="",pos=0){let wrd="",mchs=[],i=pos;for(;i<str.length;i++){let L=str.charAt(i);if(LINK_SYMBOLS_CY.includes(L)){if(mchs.length)break;wrd=""}else wrd+=L;if(wrd.length<2)continue;let occ=findSubstringOccurrences(wrd,str);if(occ.length>1)mchs.push({wrd:wrd,occ:occ});else{if(mchs.length)break;wrd=""}}return{pos:i,mchs:mchs}}function raiting(mchs,str_len=0,dict_len=0,link_len=0){let sdl=dict_len+str_len,lhr=0,lhi=-1;for(let i=0;i<mchs.length;i++){let wrd_len=mchs[i].wrd.length,occ_cnt,hr=dict_len+wrd_len+1+str_len-mchs[i].occ.length*(wrd_len-link_len)-sdl;hr>lhr&&(lhr=hr,lhi=i)}return lhi}function mutation(str="",wrd="",lnk=""){return str.replace(new RegExp(wrd,"g"),lnk)}let str=i_str,str_len=str.length,dict=[],dict_len=0,link_num=1,link=CY.ts(link_num),link_len=link.length,pos=0;for(;;){let s_res=search(str,pos);if(pos=s_res.pos,!s_res.mchs.length)break;let r_res=raiting(s_res.mchs,str_len,dict_len,link_len);r_res>-1&&(str=mutation(str,s_res.mchs[r_res].wrd,link),str_len=str.length,dict.push(s_res.mchs[r_res].wrd),dict_len+=s_res.mchs[r_res].wrd.length+1,link=CY.ts(++link_num),link=link.length>1?link[0].toUpperCase()+link.substr(1):link,link_len=link.length)}return dict_len?dict.reverse().join(",")+":"+str:str}function decompress_1(i_str=""){let arr=[],N=null,Q="",q=1;for(let sym of i_str)if(isNaN(sym))Q+=sym;else if(null===N)N=+sym;else{q=LA.tn(Q),q=q||1;for(let i=0;i<q;i++)arr.push(N);N=+sym,Q=""}q=LA.tn(Q),q=q||1;for(let i=0;i<q;i++)arr.push(N);return arr}function decompress_2(i_str=""){let[dict,str]=i_str.split(":");if(!str)return dict;dict=dict.split(",");let dictLength=dict.length,dictSyms;return dict.map((function(_,id){let sym=CY.ts(dictLength-id);return sym.length>1&&(sym=sym[0].toUpperCase()+sym.substr(1)),sym})).forEach((function(sym,i){str=str.replace(new RegExp(sym,"gm"),dict[i])})),str}function ct(){const now=new Date,day=String(now.getDate()).padStart(2,"0"),month=String(now.getMonth()+1).padStart(2,"0"),year=String(now.getFullYear()),hours=String(now.getHours()).padStart(2,"0"),minutes=String(now.getMinutes()).padStart(2,"0"),seconds=String(now.getSeconds()).padStart(2,"0"),currentTime=`${day}${month}${year}${hours}${minutes}${seconds}`;return currentTime}function validate_import_data(data){let _err=code=>Object({isValide:!1,code:code});return data.CLASSNAMES?data.TEMPLATES?data.OBJECTS?data.TEMPLATES.length!=data.CLASSNAMES.length?_err(4):data.OBJECTS.length>0&&data.OBJECTS.length!=data.CLASSNAMES.length?_err(5):{isValide:!0,code:0}:_err(3):_err(2):_err(1)}this.has_unsaved_data=function(){return has_unsaved_data},this.show_classnames=function(){console.log(CLASSNAMES)},this.show_templates=function(){console.log(TEMPLATES)},this.show_objects=function(){console.log(OBJECTS)},this.export_classes=function(include_objects=!0){let struct={CLASSNAMES:CLASSNAMES,TEMPLATES:[],OBJECTS:[],date:ct()};return that.for_each_temp((function(temp){struct.TEMPLATES.push(compress_2(compress_1(temp)))})),include_objects&&that.for_each_objs((function(objs,id){struct.OBJECTS.push([]),objs.forEach((function(obj){struct.OBJECTS[id].push(compress_2(compress_1(obj)))}))})),has_unsaved_data=!1,new Blob([JSON.stringify(struct)],{type:"application/json"})},this.export_classes_async=function(include_objects=!0,progress_cb){let struct={CLASSNAMES:CLASSNAMES,TEMPLATES:[],OBJECTS:[],date:null},total=null,curr=null,hascb=!1;function comressTemplates(){return new Promise((function(res){let current_template_id=0,total_templates_length=TEMPLATES.length;setTimeout((function _compress(){if(current_template_id>=total_templates_length)return res();struct.TEMPLATES.push(compress_2(compress_1(TEMPLATES[current_template_id]))),current_template_id++,hascb&&progress_cb(++curr,total),setTimeout(_compress,0)}),0)}))}function compressObjects(){return new Promise((function(res){if(!include_objects)return res();let current_group_id=0,current_object_id=0,total_objects_groupes=OBJECTS.length,total_objects_in_group=0;total_objects_groupes&&(total_objects_in_group=OBJECTS[current_group_id].length),struct.OBJECTS.push([]),setTimeout((function _compress(){if(current_object_id>=total_objects_in_group){if(current_group_id++,current_group_id>=total_objects_groupes)return res();current_object_id=0,total_objects_in_group=OBJECTS[current_group_id].length,struct.OBJECTS.push([])}struct.OBJECTS[current_group_id].push(compress_2(compress_1(OBJECTS[current_group_id][current_object_id]))),current_object_id++,hascb&&progress_cb(++curr,total),setTimeout(_compress,0)}),0)}))}return"function"==typeof progress_cb&&(hascb=!0,curr=0,total=TEMPLATES.length,total+=include_objects?OBJECTS.reduce((a,b)=>a+b.length,0):0),new Promise((function(res){comressTemplates().then(compressObjects).then((function(){struct.date=ct(),has_unsaved_data=!1,res(new Blob([JSON.stringify(struct)],{type:"application/json"}))}))}))},this.import_classes=function(fileContent){let data=null;try{data=JSON.parse(fileContent)}catch(error){return{success:!1,code:-1}}let validInfo=validate_import_data(data);return validInfo.isValide?(CLASSNAMES=data.CLASSNAMES,TEMPLATES=[],data.TEMPLATES.forEach((function(temp){TEMPLATES.push(decompress_1(decompress_2(temp)))})),data.OBJECTS.length?(OBJECTS=[],data.OBJECTS.forEach((function(objs,id){OBJECTS.push([]),objs.forEach((function(obj){OBJECTS[id].push(decompress_1(decompress_2(obj)))}))}))):OBJECTS=Array(data.CLASSNAMES.length).fill([]),that.length=classesConut=CLASSNAMES.length,has_unsaved_data=!1,{success:!0,code:0}):{success:!1,code:validInfo.code}},this.import_classes_async=function(fileContent,progress_cb){let data=null,total=null,curr=null,hascb=!1;function _parseData(){return new Promise((function(res,rej){try{data=JSON.parse(fileContent)}catch(error){rej({success:!1,code:-1})}let validInfo=validate_import_data(data);validInfo.isValide||rej({success:!1,code:validInfo.code}),"function"==typeof progress_cb&&(hascb=!0,curr=0,total=data.TEMPLATES.length,total+=data.OBJECTS.reduce((a,b)=>a+b.length,0)),res({success:!0,code:0})}))}function _setClassNames(){return new Promise((function(res){CLASSNAMES=data.CLASSNAMES,res()}))}function _decompressTemplates(){return new Promise((function(res){let current_template_id=0,total_templates_length=data.TEMPLATES.length;TEMPLATES=[],setTimeout((function _decompress(){if(current_template_id>=total_templates_length)return res();TEMPLATES.push(decompress_1(decompress_2(data.TEMPLATES[current_template_id]))),current_template_id++,hascb&&progress_cb(++curr,total),setTimeout(_decompress,0)}),0)}))}function _decompressObjects(){return new Promise((function(res){data.OBJECTS.length||(OBJECTS=Array(data.CLASSNAMES.length).fill([]),res());let current_group_id=0,current_object_id=0,total_objects_groupes=data.OBJECTS.length,total_objects_in_group=0;total_objects_groupes&&(total_objects_in_group=data.OBJECTS[current_group_id].length),OBJECTS=[[]],setTimeout((function _decompress(){if(current_object_id>=total_objects_in_group){if(current_group_id++,current_group_id>=total_objects_groupes)return res();current_object_id=0,total_objects_in_group=data.OBJECTS[current_group_id].length,OBJECTS.push([])}OBJECTS[current_group_id].push(decompress_1(decompress_2(data.OBJECTS[current_group_id][current_object_id]))),current_object_id++,hascb&&progress_cb(++curr,total),setTimeout(_decompress,0)}),0)}))}return new Promise((function(res,rej){_parseData().then(_setClassNames).then(_decompressTemplates).then(_decompressObjects).then((function(){that.length=classesConut=CLASSNAMES.length,has_unsaved_data=!1,res({success:!0,code:0})})).catch((function(err){rej(err)}))}))},this.get_classname_by_id=function(id=0){return CLASSNAMES[id]},this.get_class_template_by_id=function(id=0){return TEMPLATES[id]?[...TEMPLATES[id]]:[]},this.get_class_objects_by_id=function(id=0){return OBJECTS[id]?[...OBJECTS[id]]:[]},this.add_class=function(name,temp,objc){CLASSNAMES.push(name),TEMPLATES.push(temp),OBJECTS.push(objc),has_unsaved_data=!0,that.length=++classesConut},this.edit_class=function(cId,name,temp,objc){CLASSNAMES[cId]=name,TEMPLATES[cId]=temp,OBJECTS[cId]=objc,has_unsaved_data=!0},this.remove_class_by_id=function(id=0){CLASSNAMES.splice(id,1),TEMPLATES.splice(id,1),OBJECTS.splice(id,1),has_unsaved_data=CLASSNAMES.length>0,that.length=classesConut=CLASSNAMES.length},this.for_each_class=function(func){for(let i=0;i<classesConut;i++){let obj=OBJECTS[i];obj||(obj=[]),func({classname:CLASSNAMES[i],template:TEMPLATES[i],objects:obj,length:obj.length},i)}},this.for_each_temp=function(func){for(let i=0;i<that.length;i++)func(TEMPLATES[i],i)},this.for_each_objs=function(func){for(let i=0;i<that.length;i++)func(OBJECTS[i],i)}}const db=new DB;;function finding_template(arr=[]){if(arr.length<2)return null;let Z=[],S=0,t=0;for(let y=0;y<arr[0].length;y++){let sum=0;for(let x=0;x<arr.length;x++)sum+=arr[x][y];Z.push(sum),S+=sum,t+=+(sum>0)}let d=S/t;return Z.map(el=>+(el>d))}function calculate_similarity(OBJECT=[],TEMPLATE=[]){let a=0,q=0,h=0,b=0,F1=0,F2=0,F3=0,F4=0,F5=0,F6=0,F7=0,F8=0,F9=0,Length=OBJECT.length,diff=Array(Length).fill(0);for(let i=0;i<Length;i++){let obj_itm=OBJECT[i],tmp_itm=TEMPLATE[i];tmp_itm*obj_itm?(a+=1,diff[i]=1):tmp_itm*(1-obj_itm)?(q+=1,diff[i]=2):(1-tmp_itm)*obj_itm?(h+=1,diff[i]=3):(1-tmp_itm)*(1-obj_itm)&&(b+=1)}return F1=a/(a+b+q+h),F2=a/(Length-b),F3=a/(2*a+h+q),F4=a/(a+2*(q+h)),F5=(a+b)/Length,F6=a/(q+h),F7=.5*(a/(a+q)+a/(a+h)),F8=a/Math.sqrt((a+h)*(a+b)),F9=(a*b-q*h)/(a*b+q*h),{a:a,q:q,h:h,b:b,F1:F1,F2:F2,F3:F3,F4:F4,F5:F5,F6:F6,F7:F7,F8:F8,F9:F9,diff:diff}};function ViewPortResizeListener(cb){this.onresize="function"==typeof cb?cb:function(){},this.onstartlistening=function(){},this.onstoplistening=function(){};const that=this;function onresize(){that.onresize(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)}this.start_listen=function(){window.addEventListener("resize",onresize),window.addEventListener("orientationchange",onresize),document.addEventListener("fullscreenchange",onresize),that.onstartlistening(),onresize()},this.stop_listen=function(){window.removeEventListener("resize",onresize),window.removeEventListener("orientationchange",onresize),document.removeEventListener("fullscreenchange",onresize),that.onstoplistening()}}function InterfaceMenu(){let sc1=document.getElementById("sc1"),mb_addnewclass=document.getElementById("mb_addnewclass"),mb_recognition=document.getElementById("mb_recognition"),mb_classmanager=document.getElementById("mb_classmanager"),mb_reference=document.getElementById("mb_reference"),mb_settings=document.getElementById("mb_settings");const that=this;let mb_inner=document.getElementById("mb_inner"),viewPort=new ViewPortResizeListener((function(height){mb_inner.style.minHeight=height+"px"}));viewPort.start_listen(),this.open_screen=function(){sc1.classList.add("--active"),window.scroll(0,0),viewPort.start_listen()},this.close_screen=function(){sc1.classList.remove("--active"),viewPort.stop_listen()},this.onrecognition=function(){},this.onaddnewclass=function(){},this.onclassmanager=function(){},this.onreference=function(){},this.onsettings=function(){},mb_addnewclass.addEventListener("click",(function(){that.onaddnewclass()})),mb_recognition.addEventListener("click",(function(){that.onrecognition()})),mb_classmanager.addEventListener("click",(function(){that.onclassmanager()})),mb_reference.addEventListener("click",(function(){that.onreference()})),mb_settings.addEventListener("click",(function(){that.onsettings()}))};function InterfaceAddNewClass(){let sc2=document.getElementById("sc2"),ac_back_btn=document.getElementById("ac_back_btn"),classname=document.getElementById("ac_in_classname"),ac_bt_clear=document.getElementById("ac_bt_clear"),ac_bt_newobj=document.getElementById("ac_bt_newobj"),ac_bt_change=document.getElementById("ac_bt_change"),ac_bt_cnlchg=document.getElementById("ac_bt_cnlchg"),ac_bt_submit=document.getElementById("ac_bt_submit"),ac_bt_cancel=document.getElementById("ac_bt_cancel"),ac_cnv_wrp=document.getElementById("ac_cnv_wrp"),ac_obj_cnt=document.getElementById("ac_obj_cnt"),ac_obj_gal=document.getElementById("ac_obj_gal"),ac_temp_img=document.getElementById("ac_temp_img"),ac_title=document.getElementById("ac_title"),WW,HH;WW=HH=300;let temp_cnv=new Sketch(WW,HH);ac_cnv_wrp.innerHTML="";let ac_cnv=new Sketch(WW,HH,{insert_into:ac_cnv_wrp,drawing_mode:!0});ac_cnv.ctx.lineWidth=10;let sticky_navbar=new StickyNavbar("ac_navbar"),IS_EDITING=!1,CLASS_ID=0;this.objects=[],this.objects_ids=[];let objectBeingEdited=!1;this.template=[];let template_clarity=0;const that=this;function redrawTemplate(){if(template_clarity=0,that.template.length){temp_cnv.clear(),ac_temp_img.setAttribute("alt","");let tempImageData=new ImageData(WW,HH);that.template.forEach((function(el,k){el>0&&(tempImageData.data[4*k+3]=255,template_clarity++)})),temp_cnv.ctx.putImageData(tempImageData,0,0),ac_temp_img.setAttribute("src",temp_cnv.cnv.toDataURL())}else ac_temp_img.setAttribute("src","")}function refreshTemplate(){let newtemplate=finding_template(that.objects)||[];that.template=newtemplate,redrawTemplate()}function drawOnCanvas(data=[]){if(data.length){ac_cnv.clear();let tempImageData=new ImageData(WW,HH);data.forEach((function(el,k){el>0&&(tempImageData.data[4*k+3]=255)})),ac_cnv.ctx.putImageData(tempImageData,0,0)}}function getCanvasAsBinArr(){let cnt=0,binArr=[];return ac_cnv.for_each_pixel((function(rgba){rgba[3]>125?(binArr.push(1),cnt++):binArr.push(0)})),cnt?binArr:[]}function prepareToObjEditing(){ac_obj_gal.querySelectorAll(".addclass__obj-btn").forEach((function(el){el.setAttribute("disabled","true")})),ac_bt_newobj.setAttribute("disabled","true"),getParentNode(ac_bt_newobj,1).classList.add("d-none"),getParentNode(ac_bt_change,1).classList.remove("d-none"),getParentNode(ac_bt_cnlchg,1).classList.remove("d-none")}function complateObjEditing(){ac_obj_gal.querySelectorAll(".addclass__obj-btn").forEach((function(el){el.removeAttribute("disabled")})),ac_bt_newobj.removeAttribute("disabled"),getParentNode(ac_bt_newobj,1).classList.remove("d-none"),getParentNode(ac_bt_change,1).classList.add("d-none"),getParentNode(ac_bt_cnlchg,1).classList.add("d-none")}function set_editing_state(state=!1){state?(ac_bt_submit.innerText="Изменить класс",ac_title.innerText="Редактирование класса"):(ac_bt_submit.innerText="Добавить класс",ac_title.innerText="Создание нового класса"),IS_EDITING=state}function editObj(coId){return function(){if(objectBeingEdited)return;objectBeingEdited=!0;const objId=that.objects_ids.indexOf(coId),__itm=getParentNode(this,2),__img=__itm.firstChild;function __change(){let editedObj=getCanvasAsBinArr();editedObj.length&&(that.objects[objId]=editedObj,__img.src=ac_cnv.cnv.toDataURL(),refreshTemplate(),ac_cnv.clear(),complateObjEditing(),__itm.scrollIntoView(),setTimeout((function(){__itm.classList.remove("--active")}),1e3),ac_bt_change.removeEventListener("pointerdown",__change),ac_bt_cnlchg.removeEventListener("pointerdown",__cancel),objectBeingEdited=!1)}function __cancel(){ac_cnv.clear(),complateObjEditing(),__itm.scrollIntoView(),setTimeout((function(){__itm.classList.remove("--active")}),1e3),ac_bt_change.removeEventListener("pointerdown",__change),ac_bt_cnlchg.removeEventListener("pointerdown",__cancel),objectBeingEdited=!1}drawOnCanvas(that.objects[objId]),prepareToObjEditing(),__itm.classList.add("--active"),ac_cnv_wrp.scrollIntoView(!1),ac_bt_change.addEventListener("pointerdown",__change),ac_bt_cnlchg.addEventListener("pointerdown",__cancel)}}function removeObj(coId){return function(){if(objectBeingEdited)return;const objId=that.objects_ids.indexOf(coId);that.objects_ids.splice(objId,1),that.objects.splice(objId,1),getParentNode(this,2).remove(),ac_obj_cnt.innerHTML=that.objects.length,refreshTemplate()}}this.open_screen=function(){sc2.classList.add("--active"),window.scroll(0,0),sticky_navbar.start_listen(),that.reset()},this.close_screen=function(){sc2.classList.remove("--active"),sticky_navbar.stop_listen()},this.reset=function(){ac_cnv.clear(),classname.value="Класс "+(db.length+1),ac_obj_cnt.innerHTML=0,ac_obj_gal.innerHTML="",that.objects=[],that.objects_ids=[],temp_cnv.clear(),ac_temp_img.setAttribute("src",""),that.template=[],IS_EDITING&&set_editing_state(!1)},this.edit_class_by_id=function(cId=0){set_editing_state(!0),CLASS_ID=cId,classname.value=db.get_classname_by_id(cId),that.template=db.get_class_template_by_id(cId),that.objects=db.get_class_objects_by_id(cId),redrawTemplate(),ac_obj_gal.innerHTML="",ac_obj_cnt.innerHTML=that.objects.length,that.objects.forEach((function(obj,id){const coId=`${id}-${that.objects_ids.length.toString(36)}`;that.objects_ids.push(coId),temp_cnv.clear();let tempImageData=new ImageData(WW,HH);obj.forEach((function(el,k){el>0&&(tempImageData.data[4*k+3]=255)})),temp_cnv.ctx.putImageData(tempImageData,0,0),ac_obj_gal.prepend(crtElm("li","addclass__obj-item",[crtElm("img",{class:"addclass__obj-img",src:temp_cnv.cnv.toDataURL()}),crtElm("div","addclass__obj-acts",[newElem("button","addclass__obj-btn --edit").on("click",editObj(coId)),newElem("button","addclass__obj-btn --delete").on("click",removeObj(coId))])]))}))},this.oncanceled=function(){},this.onsubmited=function(){},this.onbackbtnpressed=function(){},ac_bt_clear.addEventListener("pointerdown",ac_cnv.clear),ac_bt_newobj.addEventListener("pointerdown",(function(){let newobj=getCanvasAsBinArr();if(!newobj.length)return;that.objects.push(newobj);const coId=`${Date.now().toString(36)}_${that.objects.length.toString(36)}`;that.objects_ids.push(coId),ac_obj_cnt.innerHTML=that.objects.length,ac_obj_gal.prepend(crtElm("li","addclass__obj-item",[crtElm("img",{class:"addclass__obj-img",src:ac_cnv.cnv.toDataURL()}),crtElm("div","addclass__obj-acts",[newElem("button","addclass__obj-btn --edit").on("click",editObj(coId)),newElem("button","addclass__obj-btn --delete").on("click",removeObj(coId))])])),ac_cnv.clear(),refreshTemplate()})),ac_back_btn.addEventListener("click",(function(){that.onbackbtnpressed()})),ac_bt_cancel.addEventListener("click",(function(){that.oncanceled()})),ac_bt_submit.addEventListener("click",(function(){let popup=easyPopup();return popup.set_title("Внимание"),popup.add_action_to_footer("Ок",(function(){this.close()})),classname.value?that.objects.length<2?popup.append_text_to_content("В классе должно быть как минимум 2 объекта.").open():template_clarity<2?popup.append_text_to_content("Эталон класса не сформировался.").open():(IS_EDITING?db.edit_class(CLASS_ID,classname.value,that.template,that.objects):db.add_class(classname.value,that.template,that.objects),void that.onsubmited()):popup.append_text_to_content("Укажите название класса.").open()}))};function InterfaceRecognise(){let sc3=document.getElementById("sc3"),rp_bt_back=document.getElementById("rp_bt_back"),rp_bt_rcg=document.getElementById("rp_bt_rcg"),rp_bt_cls=document.getElementById("rp_bt_cls"),rp_resinfo=document.getElementById("rp_resinfo"),rp_resinfo_txt=document.getElementById("rp_resinfo_txt"),rp_details_btn=document.getElementById("rp_details_btn"),rp_details=document.getElementById("rp_details"),rp_canvas_wrp=document.getElementById("rp_canvas_wrp"),W,H;W=H=300,rp_canvas_wrp.innerHTML="";let rp_canvas=new Sketch(W,H,{insert_into:rp_canvas_wrp,drawing_mode:!0});rp_canvas.ctx.lineWidth=10;let temp_canvas=new Sketch(W,H),that=this,sticky_navbar=new StickyNavbar("rp_navbar"),up_button=upButton();this.open_screen=function(){sc3.classList.add("--active"),sticky_navbar.start_listen(),up_button.start(),that.reset()},this.close_screen=function(){sc3.classList.remove("--active"),sticky_navbar.stop_listen(),up_button.stop()},this.reset=function(){rp_canvas.clear(),rp_canvas.enable_drawing_mode(),rp_bt_rcg.parentElement.classList.remove("d-none"),rp_resinfo.classList.add("d-none"),rp_details.classList.add("d-none"),rp_details.lastElementChild.innerHTML="",temp_canvas.clear()},this.onbackbtnpressed=function(){},rp_bt_back.addEventListener("click",(function(){that.onbackbtnpressed()})),rp_bt_rcg.addEventListener("pointerup",(function(){if(!db.length)return easyPopup().set_title("Не достаточно данных").append_text_to_content("Необходимо зарегистрировать как минимум 2 класса для возможности распознавать новые объекты.").add_action_to_footer("Ok",(function(){this.close()})).open();let cnt=0,newobj=[];if(rp_canvas.for_each_pixel((function(rgba){rgba[3]>125?(newobj.push(1),cnt++):newobj.push(0)})),!cnt)return;this.parentElement.classList.add("d-none");let classSimilarities=[];db.for_each_temp((function(temp){classSimilarities.push(calculate_similarity(newobj,temp))}));let F1=classSimilarities.map(el=>el.F1),F2=classSimilarities.map(el=>el.F2),F3=classSimilarities.map(el=>el.F3),F4=classSimilarities.map(el=>el.F4),F5=classSimilarities.map(el=>el.F5),F6=classSimilarities.map(el=>el.F6),F7=classSimilarities.map(el=>el.F7),F8=classSimilarities.map(el=>el.F8),F9=classSimilarities.map(el=>el.F9),classSimilarityScores=Array(db.length).fill(0);classSimilarityScores[F1.indexOf(Math.max(...F1))]++,classSimilarityScores[F2.indexOf(Math.max(...F2))]++,classSimilarityScores[F3.indexOf(Math.max(...F3))]++,classSimilarityScores[F4.indexOf(Math.max(...F4))]++,classSimilarityScores[F5.indexOf(Math.max(...F5))]++,classSimilarityScores[F6.indexOf(Math.max(...F6))]++,classSimilarityScores[F7.indexOf(Math.max(...F7))]++,classSimilarityScores[F8.indexOf(Math.max(...F8))]++,classSimilarityScores[F9.indexOf(Math.max(...F9))]++;let indexOfMostSimilarClass=classSimilarityScores.indexOf(Math.max(...classSimilarityScores));function __clear__(){rp_details_btn.removeEventListener("click",__showDiteils__),rp_bt_cls.removeEventListener("click",__clear__)}function __showDiteils__(){rp_details.lastElementChild.innerHTML="",classSimilarities.forEach((function(el,id){let mostProbable=indexOfMostSimilarClass===id?" --most-probable":"";rp_details.lastElementChild.append(crtElm("div",`recpanel__details-item --iid-${id}${mostProbable}`,[crtElm("div","recpanel__details-img-wrp",crtElm("img","recpanel__details-img")),crtElm("ul","recpanel__details-params",[crtElm("li","recpanel__details-param --title",db.get_classname_by_id(id)),crtElm("li","recpanel__details-param",`a = ${el.a} q = ${el.q} h = ${el.h} b = ${el.b}`),crtElm("li","recpanel__details-param",`F1 = ${el.F1}`),crtElm("li","recpanel__details-param",`F2 = ${el.F2}`),crtElm("li","recpanel__details-param",`F3 = ${el.F3}`),crtElm("li","recpanel__details-param",`F4 = ${el.F4}`),crtElm("li","recpanel__details-param",`F5 = ${el.F5}`),crtElm("li","recpanel__details-param",`F6 = ${el.F6}`),crtElm("li","recpanel__details-param",`F7 = ${el.F7}`),crtElm("li","recpanel__details-param",`F8 = ${el.F8}`),crtElm("li","recpanel__details-param",`F9 = ${el.F9}`)])])),setTimeout((function(){let img=document.querySelector(`.recpanel__details-item.--iid-${id} img`);temp_canvas.clear(),img.setAttribute("alt","");let tempImageData=new ImageData(W,H);el.diff.forEach((function(el,k){if(el>0){let i=4*k;tempImageData.data[i+3]=255,1===el?tempImageData.data[i+1]=128:3===el&&(tempImageData.data[i]=255)}})),temp_canvas.ctx.putImageData(tempImageData,0,0),img.setAttribute("src",temp_canvas.cnv.toDataURL())}),0)})),__clear__()}rp_resinfo_txt.innerText=`Образ принадлежит классу "${db.get_classname_by_id(indexOfMostSimilarClass)}"`,rp_resinfo.classList.remove("d-none"),rp_canvas.disable_drawing_mode(),rp_bt_cls.addEventListener("click",__clear__),rp_details_btn.addEventListener("click",__showDiteils__)})),rp_bt_cls.addEventListener("click",(function(){that.reset()})),rp_details_btn.addEventListener("click",(function(){rp_details.classList.toggle("d-none")}))};function InterfaceClassManager(){let sc4=document.getElementById("sc4"),cm_back=document.getElementById("cm_back"),cm_classes=document.getElementById("cm_classes"),cm_empty_ms=document.getElementById("cm_empty_ms"),cm_footer=document.getElementById("cm_footer"),cm_addclass_btn=document.getElementById("cm_addclass_btn"),cm_loadclass_btn=document.getElementById("cm_loadclass_btn"),cm_f_addclass_btn=document.getElementById("cm_f_addclass_btn"),cm_f_saveclass_btn=document.getElementById("cm_f_saveclass_btn"),cm_f_loadclass_btn=document.getElementById("cm_f_loadclass_btn"),cm_f_back_btn=document.getElementById("cm_f_back_btn"),W,H;W=H=300;let temp_canvas=new Sketch(W,H),class_ids=[];const that=this;let sticky_navbar=new StickyNavbar("cm_navbar");function ct(){const now=new Date,day=String(now.getDate()).padStart(2,"0"),month=String(now.getMonth()+1).padStart(2,"0"),year=String(now.getFullYear()),hours=String(now.getHours()).padStart(2,"0"),minutes=String(now.getMinutes()).padStart(2,"0"),seconds=String(now.getSeconds()).padStart(2,"0"),currentTime=`${day}${month}${year}${hours}${minutes}${seconds}`;return currentTime}function display_all_classes(){function _rm(cId){return function(){const rmid=class_ids.indexOf(cId),that=this;function __rm(){db.remove_class_by_id(rmid),class_ids.splice(rmid,1),getParentNode(that,3).remove(),db.length||(cm_classes.classList.add("d-none"),cm_footer.classList.add("d-none"),cm_empty_ms.classList.remove("d-none"))}easyPopup().set_title("Удалить класс?").append_text_to_content(`Вы действительно хотите удалить класс "${db.get_classname_by_id(rmid)}"?`).add_action_to_footer("Удалить",(function(){this.close(),__rm()})).add_action_to_footer("Отмена",(function(){this.close()})).open()}}function _ed(cId){return function(){that.onredirect("editclass",class_ids.indexOf(cId))}}function _rd(cId){return function(){that.onredirect("reviewclass",class_ids.indexOf(cId))}}cm_classes.classList.remove("d-none"),cm_footer.classList.remove("d-none"),cm_empty_ms.classList.add("d-none"),class_ids=[],cm_classes.innerHTML="",db.for_each_class((function(el,id){const cId=`${id}-${class_ids.length.toString(36)}`;class_ids.push(cId),cm_classes.append(crtElm("li",`classmanager__class --cId-${cId}`,[crtElm("div","classmanager__class-tmp-wrp",crtElm("img","classmanager__class-tmp")),crtElm("div","classmanager__class-info",[crtElm("h3","classmanager__class-name",el.classname),crtElm("ul","classmanager__class-info-items",[crtElm("li","classmanager__class-info-item",`Объектов: ${el.length}`)]),crtElm("div","classmanager__class-acts",[newElem("button","classmanager__class-abtn","Просмотр").on("click",_rd(cId)),newElem("button","classmanager__class-abtn","Редактировать").on("click",_ed(cId)),newElem("button","classmanager__class-abtn","Удалить").on("click",_rm(cId))])])])),setTimeout((function(){let img=document.querySelector(`.classmanager__class.--cId-${cId} img`);temp_canvas.clear(),img.setAttribute("alt","");let tempImageData=new ImageData(W,H);el.template.forEach((function(el,k){el>0&&(tempImageData.data[4*k+3]=255)})),temp_canvas.ctx.putImageData(tempImageData,0,0),img.setAttribute("src",temp_canvas.cnv.toDataURL())}),0)}))}function display_empty_msg(){cm_classes.classList.add("d-none"),cm_footer.classList.add("d-none"),cm_empty_ms.classList.remove("d-none")}function go_back(){that.onbackbtnpressed()}function add_new_class(){that.onredirect("addnewclass")}function load_classes(){newElem("input",{type:"file",accept:".json"}).on("change",(function(){let selectedFile=event.target.files[0];if(selectedFile&&selectedFile.name.endsWith(".json")){let reader=new FileReader;reader.onload=function(e){let fileContent=e.target.result,popup=easyPopup();popup.set_title("Загрузка классов"),popup.disable_close_btn(),popup.open();let pr=null;popup.append_to_content(crtElm("div","popup__content-p",[crtElm("div","","Подготовка..."),newElem("progress",{value:0,max:1}).getRef(el=>pr=el)])),db.import_classes_async(fileContent,(function(curr,total){pr.setAttribute("max",total),pr.setAttribute("value",curr)})).then((function(){popup.clear_content().enable_close_btn(),popup.append_text_to_content("Классы успешно загружены."),popup.add_action_to_footer("Ок",(function(){this.close()})),display_all_classes()})).catch((function(err){popup.set_title("Ошибка").clear_content().enable_close_btn(),popup.append_text_to_content("Не удалось загрузить классы."),popup.append_text_to_content("Возможно файл повреждён или не соответствует стандарту программы."),popup.append_text_to_content(`Код ошибки ${err.code}.`),popup.add_action_to_footer("Ок",(function(){this.close()}))}))},reader.readAsText(selectedFile)}else easyPopup().set_title("Ошибка").append_text_to_content("Выберите файл с расширением .json").add_action_to_footer("Ок",(function(){this.close()})).open()})).click()}function before_load_classes(){db.has_unsaved_data()?easyPopup().set_title("Загрузить классы?").append_text_to_content("Возможно, внесённые изменения не сохранятся.").add_action_to_footer("Загрузить",(function(){this.close(),load_classes()})).add_action_to_footer("Отмена",(function(){this.close()})).open():load_classes()}this.open_screen=function(){sc4.classList.add("--active"),sticky_navbar.start_listen(),window.scroll(0,0),db.length?display_all_classes():display_empty_msg()},this.close_screen=function(){sc4.classList.remove("--active"),sticky_navbar.stop_listen()},this.onbackbtnpressed=function(){},this.onredirect=function(){},cm_back.addEventListener("click",go_back),cm_f_back_btn.addEventListener("click",go_back),cm_addclass_btn.addEventListener("click",add_new_class),cm_f_addclass_btn.addEventListener("click",add_new_class),cm_loadclass_btn.addEventListener("click",before_load_classes),cm_f_loadclass_btn.addEventListener("click",before_load_classes),cm_f_saveclass_btn.addEventListener("click",(function(){let popup=easyPopup(),include_objects=!0;popup.set_title("Экспортировать классы"),popup.append_to_content(crtElm("label","",[newElem("input",{type:"checkbox",checked:"true"}).on("change",(function(){include_objects=this.checked}))," Включить объекты классов."])).add_action_to_footer("Ok",(function(){popup.clear_content().disable_close_btn().remove_actions_from_footer();let pr=null;popup.append_to_content(crtElm("div","popup__content-p",[crtElm("div","","Подготовка..."),newElem("progress",{value:0,max:1}).getRef(el=>pr=el)])),db.export_classes_async(include_objects,(function(curr,total){pr.setAttribute("max",total),pr.setAttribute("value",curr)})).then((function(exportBlob){popup.clear_content().enable_close_btn(),popup.append_to_content(crtElm("p","popup__content-p","Классы готовы к экспорту.")),popup.add_action_to_footer("Сохранить",(function(){crtElm("a",{download:`export.${ct()}.json`,href:URL.createObjectURL(exportBlob)}).click(),this.close()}))}))})).add_action_to_footer("Отмена",(function(){this.close()})),popup.open()}))};function InterfaceClassReview(){let sc5=document.getElementById("sc5"),cr_back=document.getElementById("cr_back"),cr_edit_btn=document.getElementById("cr_edit_btn"),cr_remove_btn=document.getElementById("cr_remove_btn"),cr_f_back_btn=document.getElementById("cr_f_back_btn"),cr_title=document.getElementById("cr_title"),cr_temp_gal=document.getElementById("cr_temp_gal"),cr_obj_gal=document.getElementById("cr_obj_gal"),W,H;W=H=300;let temp_canvas=new Sketch(W,H),classid=-1;const that=this;let sticky_navbar=new StickyNavbar("cr_navbar");function displayTemplate(cId=0){cr_temp_gal.innerHTML="",cr_temp_gal.append(crtElm("li","classreview__gal-item --template",crtElm("img","classreview__img")));let template=db.get_class_template_by_id(cId);setTimeout((function(){let img=document.querySelector(".classreview__gal-item.--template img");temp_canvas.clear(),img.setAttribute("alt","");let tempImageData=new ImageData(W,H);template.forEach((function(el,k){el>0&&(tempImageData.data[4*k+3]=255)})),temp_canvas.ctx.putImageData(tempImageData,0,0),img.setAttribute("src",temp_canvas.cnv.toDataURL())}),0)}function displayObjects(cId=0){let objects;cr_obj_gal.innerHTML="",db.get_class_objects_by_id(cId).forEach((function(obj,id){cr_obj_gal.append(crtElm("li",`classreview__gal-item --oId-${id}`,crtElm("img","classreview__img"))),setTimeout((function(){let img=document.querySelector(`.classreview__gal-item.--oId-${id} img`);temp_canvas.clear(),img.setAttribute("alt","");let tempImageData=new ImageData(W,H);obj.forEach((function(el,k){el>0&&(tempImageData.data[4*k+3]=255)})),temp_canvas.ctx.putImageData(tempImageData,0,0),img.setAttribute("src",temp_canvas.cnv.toDataURL())}),0)}))}function go_back(){that.onbackbtnpressed()}this.open_screen=function(){sc5.classList.add("--active"),sticky_navbar.start_listen(),window.scroll(0,0)},this.close_screen=function(){sc5.classList.remove("--active"),sticky_navbar.stop_listen()},this.set_class_to_review=function(cId){classid=cId,cr_title.innerText=db.get_classname_by_id(cId),displayTemplate(cId),displayObjects(cId)},this.onbackbtnpressed=function(){},this.onredirect=function(){},cr_back.addEventListener("click",go_back),cr_f_back_btn.addEventListener("click",go_back),cr_edit_btn.addEventListener("click",(function(){that.onredirect("editclass",classid)})),cr_remove_btn.addEventListener("click",(function(){easyPopup().set_title("Удалить класс").append_text_to_content(`Вы действительно хотите удалить класс "${cr_title.innerText}"?`).add_action_to_footer("Удалить",(function(){this.close(),db.remove_class_by_id(classid),that.onbackbtnpressed()})).add_action_to_footer("Отмена",(function(){this.close()})).open()}))};function InterfaceReference(){let sc6=document.getElementById("sc6"),rf_back_btn=document.getElementById("rf_back_btn"),sticky_navbar=new StickyNavbar("rf_navbar");const that=this;this.open_screen=function(){sc6.classList.add("--active"),window.scroll(0,0),sticky_navbar.start_listen()},this.close_screen=function(){sc6.classList.remove("--active"),sticky_navbar.stop_listen()},this.onbackbtnpressed=function(){},rf_back_btn.addEventListener("click",(function(){that.onbackbtnpressed()}))};window.addEventListener("load",(function(){let screen1=new InterfaceMenu,screen2=new InterfaceAddNewClass,screen3=new InterfaceRecognise,screen4=new InterfaceClassManager,screen5=new InterfaceClassReview,screen6=new InterfaceReference,theHistory=[screen1];theHistory.last=function(){return this[this.length-1]},theHistory.back=function(){theHistory.length<2||(theHistory.pop().close_screen(),theHistory.last().open_screen())},screen1.onaddnewclass=function(){screen1.close_screen(),screen2.open_screen(),theHistory.push(screen2)},screen1.onrecognition=function(){if(db.length<2)return easyPopup().set_title("Не достаточно данных").append_text_to_content("Необходимо зарегистрировать как минимум два класса для возможности распознавать новые образы.").add_action_to_footer("Ok",(function(){this.close()})).open();screen1.close_screen(),screen3.open_screen(),theHistory.push(screen3)},screen1.onclassmanager=function(){screen1.close_screen(),screen4.open_screen(),theHistory.push(screen4)},screen1.onreference=function(){screen1.close_screen(),screen6.open_screen(),theHistory.push(screen6)},screen2.oncanceled=theHistory.back,screen2.onsubmited=theHistory.back,screen2.onbackbtnpressed=theHistory.back,screen4.onbackbtnpressed=theHistory.back,screen4.onredirect=function(link=""){"addnewclass"===link?(screen4.close_screen(),screen2.open_screen(),theHistory.push(screen2)):"editclass"===link?(screen4.close_screen(),screen2.open_screen(),screen2.edit_class_by_id(arguments[1]),theHistory.push(screen2)):"reviewclass"===link&&(screen4.close_screen(),screen5.open_screen(),screen5.set_class_to_review(arguments[1]),theHistory.push({cId:arguments[1],open_screen:function(){screen5.open_screen(),screen5.set_class_to_review(this.cId)},close_screen:function(){screen5.close_screen()}}))},screen5.onbackbtnpressed=theHistory.back,screen5.onredirect=function(link){"editclass"===link&&(screen5.close_screen(),screen2.open_screen(),screen2.edit_class_by_id(arguments[1]),theHistory.push(screen2))},screen3.onbackbtnpressed=theHistory.back,screen6.onbackbtnpressed=theHistory.back})),window.addEventListener("beforeunload",(function(event){db.has_unsaved_data()&&(event.preventDefault(),event.returnValue="")}));</script></body></html>